User Auth - Signup & Signin
------------------------------------------------

1. Signup
------------------------------------------------

install "brcyptjs" and "@types/brcyptjs" packages.

create module, service and controller for auth using nest CLI (now you know the commands)

also make sure to add the AuthService in exports array of the AuthModule 

create user module and service as well

steps
--------
1. find the user service and inside imports array add our entity repository so we can inject it.

2. find the auth module and in imports array add the UsersModule otherwise we cant use it

3. inside the auth controller create the post endpoint "signup" 

4. inject the user repository to user service and implement create function inside user service

5. what happen is when we call auth controller signup endpoint it call the user service create function.


2. Signin
-----------------------------------------------------

since we going to impleement jwt using passport auth strategy, install
the following packages first.

@nestjs/passport
passport

steps
----------------
1. go to auth controller and create login route

2. next go to auth service and create login function in that function use
email to pass inside to find the target user and make sure to use userService inside auth service.

3. in the auth controller inject auth service and call the login function in signin endpoint

3. JWT auth setup
-----------------------------------

import jwt module to auth module
and imports array add JwtModule.register({secret: "your_sec_key" , signOptions: {expiresIn:"1d"}})

next create a jwt-strategy.ts in auth folder (sort of a provider which can be injected)

import { Injectable } from '@nestjs/common';
import { PassportStrategy } from '@nestjs/passport';
import { ExtractJwt, Strategy } from 'passport-jwt';
import { constants } from 'src/common/constants/constants';

@Injectable()
export class JwtStrategy extends PassportStrategy(Strategy) {
  constructor() {
    super({
      jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),
      ignoreExpiration: false,
      secretOrKey: constants.secret,
    });
  }

  validate(payload: { email: string; sub: string }) {
    return { userId: payload.sub, email: payload.email };
  }
}

next register the jwt strategy in auth module

then create auth guard .ts file it is also an injectable file

import { Injectable } from '@nestjs/common';
import { AuthGuard } from '@nestjs/passport';

@Injectable()
export class JwtAuthGuard extends AuthGuard('jwt') {}

now you have to add the following line with passing guard
@UseGuards(JwtAuthGuard)
this will protect the